# In Emacs org-mode: before exporting, comment this out START
;; Local Variables:
;; ispell-check-comments: exclusive
;; ispell-local-dictionary: "english"
;; End:
# In Emacs org-mode: before exporting, comment this out FINISH

# Org-mode Export LaTeX Customization Notes:
# - Interpret 'bla_bla' as LaTeX Math bla subscript bla: #+OPTIONS ^:t. Interpret literally bla_bla: ^:nil.
# - org export: turn off heading -> section numbering: #+OPTIONS: num:nil
# - org export: change list numbering to alphabetical, sources:
#   - https://orgmode.org/manual/Plain-lists-in-LaTeX-export.html
#   - https://tex.stackexchange.com/a/129960
#   - must be inserted before each list:
#     #+ATTR_LATEX: :environment enumerate
#     #+ATTR_LATEX: :options [label=\alph*)]
# - allow org to recognize alphabetical lists a)...: M-x customize-variable org-list-allow-alphabetical


# -----------------------
# General Export Options:
#+OPTIONS: ^:nil ':nil *:t -:t ::t <:t H:3 \n:nil arch:headline 
#+OPTIONS: broken-links:nil c:nil creator:nil d:(not "LOGBOOK") date:t e:t
#+OPTIONS: email:nil f:t inline:t p:nil pri:nil prop:nil stat:t tags:t
#+OPTIONS: tasks:t tex:t timestamp:t title:t todo:t |:t

#+OPTIONS: author:nil
#+OPTIONS: num:nil # disable export latex section numbering for org headings
#+OPTIONS: toc:nil # no table of contents (doesn't work if num:nil)

#+TITLE: SiScLab_Task3-JupyterGUICompletion_Notes
#+DATE: <2019-01-15 Tue>
#+AUTHOR: Johannes Wasmer
# #+EMAIL: johannes.wasmer@gmail.com
#+LANGUAGE: de
#+SELECT_TAGS: export
#+EXCLUDE_TAGS: noexport
#+CREATOR: Emacs 25.2.2 (Org mode 9.1.13)

# ---------------------
# LaTeX Export Options:
#+LATEX_CLASS: article
#+LATEX_CLASS_OPTIONS:
#+LATEX_HEADER: \usepackage[english]{babel}
#+LATEX_HEADER: \usepackage[top=0.5in,bottom=0.5in,left=1in,right=1in,includeheadfoot]{geometry} % wider page; load BEFORE fancyhdr
#+LATEX_HEADER: \usepackage[inline]{enumitem} % for customization of itemize, enumerate envs
#+LATEX_HEADER: \usepackage{color}
#+LATEX_HEADER:
#+LATEX_HEADER_EXTRA:
#+DESCRIPTION:
#+KEYWORDS:
#+SUBTITLE: 
#+LATEX_COMPILER: pdflatex
#+DATE: \today


This is a list of unfinished subtasks for the completion of the project's
Jupyter dashboard (GUI) up to the project presentation on <2019-01-25 Fri>.

* [[file:SiScLab_Notes.org::*%5B%5Bfile:SiScLab_Task3-JupyterGUICompletion_Notes.org%5D%5BPhase%204%20-%20Jupyter%20GUI%20Completion%5D%5D][Master File]]
* DONE =plot.py=: ~setup_plot~ problem
  CLOSED: [2019-01-15 Tue 16:25]
- labels don't get set on plot
- only works if the ~setup_plot~ stuff is called inside the Jupyter ~@interact~
  function ~update_plot~
- DONE: wrote documentation with example on correct usage. removed from
  ~__init__~ method.
* DONE Widget: y-axis range
  CLOSED: [2019-01-15 Tue 19:14]
- because need know ylim before first plotting to set slider range, cannot get
  it from ~plt~ or ~ax~. Instead, added fct ~get_data_ylim~ to ~plot.py~
  classes.
* Widget: ignore_atoms_per_group
takes weight away in tensor product or sth.
* TODO Widget: spin selection
* TODO File Chooser
** HDF file chooser
** DOS file chooser
* TODO Dashboard Layout
** DONE Replace =@interact= with =interactive=
   CLOSED: [2019-01-16 Wed 00:26]
- [[https://stackoverflow.com/a/48349991][Nice example: put widgets including plot into a layout container]]
- got a dashboard layout working for the control widgets with the plot above.
  see notebook banddos07. Produced with trial and error. It IS plotting, but it
  is approximately 100x times slower than the version with =@interact= in
  banddos05.
- WHY? Probably because I use ~plt.show()~ now. or perhaps because bandddos07 is
  so full with redundant layout definitions. perhaps try to isolate the working
  code in a new banddos08, and try with that.
- UPDATE: restarted jupyter-lab. Now the dashboard version banddos07 is as fast
  as banddos05. 
** Find some resources on jupyter-widgets dashboarding
- found:  [[https://github.com/JuanCab/AstroInteractives][JuanCab/AstroInteractives]] 

** TODO Simple Layout: Bandplot Widgets in a =HBox=
** TODO Advanced Layout: Dashboard
* BandDOS Plot Layout Integration
** Linked selection widgets (masks):
*** interstitial (new, DOS-specific)
*** groups
*** spin (1-2 DOS files, switch data)
** DONE Basic Implementation
   CLOSED: [2019-01-09 Wed]
** TODO Fig arrangement
** TODO Interactive DOS plot de/activation based on [[*DOS file chooser][DOS file chooser]]
* TODO Plot File Export
** TODO export tex
** TODO Plot Title Widget
* Compare2Characters: add colorbar
- help: see [[https://matplotlib.org/api/_as_gen/matplotlib.pyplot.colorbar.html][here]]

* TODO AtomsGroup plot
** DONE Highlight Selected AtomsGroups 
   CLOSED: [2019-01-09 Wed]
** TODO AtomsGroup Selection Widget: ElementName labels
** TODO Plot: Coloring by AtomsGroup
** TODO Plot: Coloring by Element, plus switcher
* TODO Sodium.hdf: 
** TODO if not present: hide unfolding_weight selection widget
** TODO Reproduce band selection error

- error: =ValueError: cannot reshape array of size 1996 into shape (2495,)=
- error: =ValueError: cannot reshape array of size 1996 into shape (3992,)=
- =(3992,)= is the shape of each of ~(k_r, E_r, W_r) = data.reshape_data()~
:error_output_jupyter:
#+BEGIN_EXAMPLE
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
~/anaconda3/envs/masci-tools/lib/python3.6/site-packages/ipywidgets/widgets/interaction.py in update(self, *args)
    249                     value = widget.get_interact_value()
    250                     self.kwargs[widget._kwarg] = value
--> 251                 self.result = self.f(**self.kwargs)
    252                 show_inline_matplotlib_plots()
    253                 if self.auto_display and self.result is not None:

<ipython-input-15-d7b15281026e> in update_plot(bands, characters, groups, unfolding_weight_exponent, marker_size, compare_characters, ylim)
     33 
     34     plot(mask_bands, mask_characters, mask_groups, spin, 
---> 35          unfolding_weight_exponent, compare_characters, ax, ignore_atoms_per_group, marker_size)
     36 
     37 #     if is_initial_plot:

<ipython-input-6-be4fe14fc992> in plot(mask_bands, mask_characters, mask_groups, spin, unfolding_weight_exponent, isCharacterPlot, ax, ignore_atoms_per_group, marker_size)
      9     else:
     10         bandplotter.bands(mask_bands, mask_characters, mask_groups, spin, unfolding_weight_exponent, 
---> 11                           ax, alpha, ignore_atoms_per_group, marker_size)
     12 

~/Desktop/Studium/Kurse_RWTH/SiScLab/18W/repos/masci-tools/studenproject18ws/plot/plot.py in bands(self, mask_bands, mask_characters, mask_groups, spin, unfolding_weight_exponent, ax, alpha, ignore_atoms_per_group, marker_size)
    116         color = "blue"
    117         (k_r, E_r, W_r) = self.data.reshape_data(mask_bands, mask_characters, mask_groups, spin,
--> 118                                                  unfolding_weight_exponent, ignore_atoms_per_group)
    119 
    120         # just plot points with minimal size of t

~/Desktop/Studium/Kurse_RWTH/SiScLab/18W/repos/masci-tools/studenproject18ws/hdf/output_types.py in reshape_data(self, mask_bands, mask_characters, mask_groups, spin, unfolding_weight_exponent, ignore_atoms_per_group)
    204 
    205         evs_resh = np.reshape(evs, Nk * Ne)
--> 206         weight_resh = np.reshape(total_weight[0].T, Nk * Ne)
    207         k_resh = np.tile(self.k_distances, Ne)
    208         return (k_resh, evs_resh, weight_resh)

~/anaconda3/envs/masci-tools/lib/python3.6/site-packages/numpy/core/fromnumeric.py in reshape(a, newshape, order)
    277            [5, 6]])
    278     """
--> 279     return _wrapfunc(a, 'reshape', newshape, order=order)
    280 
    281 

~/anaconda3/envs/masci-tools/lib/python3.6/site-packages/numpy/core/fromnumeric.py in _wrapfunc(obj, method, *args, **kwds)
     49 def _wrapfunc(obj, method, *args, **kwds):
     50     try:
---> 51         return getattr(obj, method)(*args, **kwds)
     52 
     53     # An AttributeError occurs if the object does not have

ValueError: cannot reshape array of size 1996 into shape (2495,)
#+END_EXAMPLE
:END:

